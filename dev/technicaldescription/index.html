<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Technical description · ApproximateVI</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="ApproximateVI logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ApproximateVI</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../moreoptions/">More options</a></li><li class="is-active"><a class="tocitem" href>Technical description</a><ul class="internal"><li><a class="tocitem" href="#ELBO-maximisation"><span>ELBO maximisation</span></a></li><li><a class="tocitem" href="#Monitoring-ELBO-on-an-independent-test-set-of-samples"><span>Monitoring ELBO on an independent test set of samples</span></a></li></ul></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Technical description</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Technical description</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ngiann/ApproximateVI.jl/blob/master/docs/src/technicaldescription.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Technical-description"><a class="docs-heading-anchor" href="#Technical-description">Technical description</a><a id="Technical-description-1"></a><a class="docs-heading-anchor-permalink" href="#Technical-description" title="Permalink"></a></h1><h2 id="ELBO-maximisation"><a class="docs-heading-anchor" href="#ELBO-maximisation">ELBO maximisation</a><a id="ELBO-maximisation-1"></a><a class="docs-heading-anchor-permalink" href="#ELBO-maximisation" title="Permalink"></a></h2><p>Our goal is to approximate the true (unnormalised) posterior  distribution <span>$p(\theta|\mathcal{D})$</span> with a Gaussian <span>$q(\theta) = \mathcal{N}(\theta|\mu,\Sigma)$</span> by  maximising the expected lower bound:</p><p><span>$\int q(\theta) \log p(x, \theta) d\theta + \mathcal{H}[q]$</span>,</p><p>also known as the ELBO. The above integral is approximated with as a Monte carlo average over <span>$S$</span> number of samples:</p><p><span>$\frac{1}{S} \sum_{s=1}^S \log p(x, \theta_s) + \mathcal{H}[q]$</span>.</p><p>Using the reparametrisation trick, we re-introduce the variational parameters that we need to optimise:</p><p><span>$\frac{1}{S} \sum_{s=1}^S \log p(x, \mu + C z_s) + \mathcal{H}[q]$</span>,</p><p>where <span>$z_s\sim\mathcal{N}(0,I)$</span> and <span>$C$</span> is a matrix root of <span>$\Sigma$</span>, i.e. <span>$CC^T = \Sigma$</span>.</p><p>By maximising the approximate ELBO with respect to the variational parameters <span>$\mu$</span> and <span>$C$</span> we obtain the approximate posterior <span>$q(\theta) = \mathcal{N}(\theta|\mu,CC^T)$</span> that is the best Gaussian approximation to true posterior <span>$p(\theta|\mathcal{D})$</span>.</p><p>The number of samples <span>$S$</span> in the above description, can be controlled via the option <code>S</code> when calling <code>VI</code>. </p><h2 id="Monitoring-ELBO-on-an-independent-test-set-of-samples"><a class="docs-heading-anchor" href="#Monitoring-ELBO-on-an-independent-test-set-of-samples">Monitoring ELBO on an independent test set of samples</a><a id="Monitoring-ELBO-on-an-independent-test-set-of-samples-1"></a><a class="docs-heading-anchor-permalink" href="#Monitoring-ELBO-on-an-independent-test-set-of-samples" title="Permalink"></a></h2><p>This package implements variational inference using the re-parametrisation trick. Contrary to other flavours of this method, that repeatedly draw <span>$S$</span> new samples <span>$z_s$</span> at each iteration of the optimiser, here we draw at the start  a large number <span>$S$</span> of samples <span>$z_s$</span> and keep them fixed throughout the execution of the algorithm<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>. This avoids the difficulty of working with a noisy gradient and allows the use of optimisers like <a href="https://julianlsolvers.github.io/Optim.jl/stable/#algo/lbfgs/">LBFGS</a>. Using LBFGS, does away with the typical requirement of tuning learning rates (step sizes). However, this comes at the expense of risking overfitting to the samples <span>$z_s$</span> that happened to be drawn at the start. </p><p>The package provides a mechanism for monitoring potential overfitting<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup> via the options <code>Stest</code> and <code>test_every</code>, see <a href="../moreoptions/#Evaluating-the-lower-bound-on-test-samples">Evaluating the lower bound on test samples</a>. Indepedently of the samples <span>$z_s$</span>, a test set of <span>$S^{(test)}$</span> number of samples, denoted as <span>$z_s^{(test)}$</span>, is drawn and kept kept fixed. This second set of sample is used to periodically monitor the ELBO:</p><p><span>$\frac{1}{S^{(test)}} \sum_{s=1}^{S^{(test)}} \log p(x, \mu + C z_s^{(test)}) + \mathcal{H}[q]$</span>,</p><p>Because of fixing the samples  <span>$z_s$</span>, the algorithm doesn&#39;t not enjoy the same scalability as variational inference with stochastic gradient does. As a consequence,  the present package is recommented for problems with relatively few parameters, e.g. 2-20 parameters perhaps.</p><p>The work was independently developed and published <a href="https://doi.org/10.1007/s10044-015-0496-9">here</a> <a href="https://arxiv.org/pdf/1906.04507.pdf">(Arxiv link)</a>. Of course, the method has been widely popularised by the works <a href="http://proceedings.mlr.press/v32/titsi as14.pdf">Doubly Stochastic Variational Bayes for non-Conjugate Inference</a> and <a href="https://arxiv.org/abs/1312.6114">Auto-Encoding Variational Bayes</a>. The method seems to have appeared earlier in <a href="https://arxiv.org/abs/1206.6679">Fixed-Form Variational Posterior Approximation through Stochastic Linear Regression</a> and again later in <a href="https://link.springer.com/article/10.1007%2Fs00180-015-0638-y">A comparison of variational approximations for fast inference in mixed logit models</a> and perhaps in other publications too...</p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>See <a href="https://arxiv.org/pdf/1906.04507.pdf">paper</a>, Algorithm 1.</li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a>See <a href="https://arxiv.org/pdf/1906.04507.pdf">paper</a>, Section 2.3.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../moreoptions/">« More options</a><a class="docs-footer-nextpage" href="../examples/">Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Thursday 24 November 2022 19:36">Thursday 24 November 2022</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
